{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Abdul Rehman\\\\Desktop\\\\Project\\\\First_And_Second_Module_v1.0\\\\frontend\\\\src\\\\AdminComponents\\\\finance\\\\debtors\\\\DebtorsList.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport Search from \"./Search\";\nimport Table from \"./Table\";\nimport axios from \"../../../store/axios\";\nimport { errorAlert, currentCurrency } from \"../../../utils\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst tableHeader = [{\n  id: \"userID\",\n  name: \"Student ID\"\n}, {\n  id: \"name\",\n  name: \"Name\"\n}, {\n  id: \"classID\",\n  name: \"Class\"\n}, {\n  id: \"total\",\n  name: `Total Fees ${currentCurrency()}`\n}, {\n  id: \"amount\",\n  name: `Amount Paid ${currentCurrency()}`\n}, {\n  id: \"owe\",\n  name: `Amount Owed ${currentCurrency()}`\n}];\nfunction DebtorsList() {\n  _s();\n  const [data, setdata] = useState([]);\n  const [year, setyear] = useState(\"\");\n  const [term, setterm] = useState(\"\");\n  const [classID, setclassID] = useState(\"all\");\n  const [campus, setcampus] = useState(\"\");\n  const [amount, setamount] = useState(\"\");\n  const [show, setshow] = useState(false);\n  const [loading, setloading] = useState(false);\n  const [fees, setfees] = useState([]);\n  const [selectedterm, setselectedterm] = useState(\"\");\n  const [selectedyear, setselectedyear] = useState(\"\");\n  useEffect(() => {\n    axios.get(\"/fees\").then(res => {\n      setfees(res.data);\n    });\n  }, []);\n  const handleSearch = () => {\n    if (!year) {\n      return errorAlert(\"Please select year\");\n    }\n    if (!term) {\n      return errorAlert(\"Please select term\");\n    }\n    setloading(true);\n    let bal = u => {\n      let fee = fees.find(z => (z === null || z === void 0 ? void 0 : z.code) === (u === null || u === void 0 ? void 0 : u.classID));\n      if (fee) {\n        return fee ? Object.values(fee[u === null || u === void 0 ? void 0 : u.status] || {}).reduce((t, v) => Number(t) + Number(v), 0) : 0;\n      }\n      return 0;\n    };\n    axios.get(`/students/unpaidfees/${year}/${term}`).then(res => {\n      let students = res.data.map(e => {\n        let total = bal(e);\n        return {\n          ...e,\n          bill: total,\n          owe: total - e.amount,\n          total\n        };\n      });\n      let dataAll = students.filter(e => e.owe > 0);\n      if (classID !== \"all\") {\n        dataAll = dataAll.filter(e => e.classID === classID);\n      }\n      setdata(dataAll);\n      setshow(true);\n      setloading(false);\n      setselectedyear(year);\n      setselectedterm(term);\n    });\n  };\n  const handlePrint = () => {\n    window.print();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \" Debtors List\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content__container mb-5\",\n      children: /*#__PURE__*/_jsxDEV(Search, {\n        year: year,\n        setyear: setyear,\n        term: term,\n        campus: campus,\n        setcampus: setcampus,\n        classID: classID,\n        setclassID: setclassID,\n        amount: amount,\n        handleSearch: handleSearch,\n        setterm: setterm,\n        loading: loading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), show && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content__container\",\n        id: \"section-to-print\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\"DEBTORS LIST FOR Term \", selectedterm, \"/ \", selectedyear]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Table, {\n          noData: \"No debtors yet\",\n          tableHeader: tableHeader,\n          data: data\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center my-3\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handlePrint,\n          className: \"btn blue__btn mr-2\",\n          children: \"Print\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n}\n_s(DebtorsList, \"1oq+LlAP5L3hjYlD1GlYn5dH8Tc=\");\n_c = DebtorsList;\nexport default DebtorsList;\nvar _c;\n$RefreshReg$(_c, \"DebtorsList\");","map":{"version":3,"names":["React","useEffect","useState","Search","Table","axios","errorAlert","currentCurrency","jsxDEV","_jsxDEV","Fragment","_Fragment","tableHeader","id","name","DebtorsList","_s","data","setdata","year","setyear","term","setterm","classID","setclassID","campus","setcampus","amount","setamount","show","setshow","loading","setloading","fees","setfees","selectedterm","setselectedterm","selectedyear","setselectedyear","get","then","res","handleSearch","bal","u","fee","find","z","code","Object","values","status","reduce","t","v","Number","students","map","e","total","bill","owe","dataAll","filter","handlePrint","window","print","children","fileName","_jsxFileName","lineNumber","columnNumber","className","noData","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Abdul Rehman/Desktop/Project/First_And_Second_Module_v1.0/frontend/src/AdminComponents/finance/debtors/DebtorsList.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Search from \"./Search\";\nimport Table from \"./Table\";\nimport axios from \"../../../store/axios\";\nimport { errorAlert, currentCurrency } from \"../../../utils\";\n\nconst tableHeader = [\n  { id: \"userID\", name: \"Student ID\" },\n  { id: \"name\", name: \"Name\" },\n  { id: \"classID\", name: \"Class\" },\n  { id: \"total\", name: `Total Fees ${currentCurrency()}` },\n  { id: \"amount\", name: `Amount Paid ${currentCurrency()}` },\n  { id: \"owe\", name: `Amount Owed ${currentCurrency()}` },\n];\n\nfunction DebtorsList() {\n  const [data, setdata] = useState([]);\n  const [year, setyear] = useState(\"\");\n  const [term, setterm] = useState(\"\");\n  const [classID, setclassID] = useState(\"all\");\n  const [campus, setcampus] = useState(\"\");\n  const [amount, setamount] = useState(\"\");\n  const [show, setshow] = useState(false);\n  const [loading, setloading] = useState(false);\n  const [fees, setfees] = useState([]);\n  const [selectedterm, setselectedterm] = useState(\"\");\n  const [selectedyear, setselectedyear] = useState(\"\");\n\n  useEffect(() => {\n    axios.get(\"/fees\").then((res) => {\n      setfees(res.data);\n    });\n  }, []);\n\n  const handleSearch = () => {\n    if (!year) {\n      return errorAlert(\"Please select year\");\n    }\n    if (!term) {\n      return errorAlert(\"Please select term\");\n    }\n    setloading(true);\n\n    let bal = (u) => {\n      let fee = fees.find((z) => z?.code === u?.classID);\n      if (fee) {\n        return fee\n          ? Object.values(fee[u?.status] || {}).reduce(\n              (t, v) => Number(t) + Number(v),\n              0\n            )\n          : 0;\n      }\n      return 0;\n    };\n    axios.get(`/students/unpaidfees/${year}/${term}`).then((res) => {\n      let students = res.data.map((e) => {\n        let total = bal(e);\n        return {\n          ...e,\n          bill: total,\n          owe: total - e.amount,\n          total,\n        };\n      });\n      let dataAll = students.filter((e) => e.owe > 0);\n\n      if (classID !== \"all\") {\n        dataAll = dataAll.filter((e) => e.classID === classID);\n      }\n      setdata(dataAll);\n      setshow(true);\n      setloading(false);\n      setselectedyear(year);\n      setselectedterm(term);\n    });\n  };\n\n  const handlePrint = () => {\n    window.print();\n  };\n\n  return (\n    <div>\n      <h3> Debtors List</h3>\n      <div className=\"content__container mb-5\">\n        <Search\n          year={year}\n          setyear={setyear}\n          term={term}\n          campus={campus}\n          setcampus={setcampus}\n          classID={classID}\n          setclassID={setclassID}\n          amount={amount}\n          handleSearch={handleSearch}\n          setterm={setterm}\n          loading={loading}\n        />\n      </div>\n      {show && (\n        <>\n          <div className=\"content__container\" id=\"section-to-print\">\n            <div className=\"text-center\">\n              <h3>\n                DEBTORS LIST FOR Term {selectedterm}/ {selectedyear}\n              </h3>\n            </div>\n            <Table\n              noData=\"No debtors yet\"\n              tableHeader={tableHeader}\n              data={data}\n            />\n          </div>\n          <div className=\"text-center my-3\">\n            <button onClick={handlePrint} className=\"btn blue__btn mr-2\">\n              Print\n            </button>\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default DebtorsList;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}