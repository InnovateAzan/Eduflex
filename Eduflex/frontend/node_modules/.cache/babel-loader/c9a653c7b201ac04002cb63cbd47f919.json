{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Abdul Rehman\\\\Desktop\\\\Project\\\\First_And_Second_Module_v1.0\\\\frontend\\\\src\\\\AdminComponents\\\\finance\\\\billReminder\\\\DebtorsList.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport Search from \"./Search\";\nimport Table from \"./Table\";\nimport axios from \"../../../store/axios\";\nimport Reminder from \"./SendLetter\";\nimport Message from \"./SendMessage\";\nimport { currentCurrency } from \"../../../utils\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst tableHeader = [{\n  id: \"userID\",\n  name: \"Student ID\"\n}, {\n  id: \"name\",\n  name: \"Name\"\n}, {\n  id: \"classID\",\n  name: \"Class\"\n}, {\n  id: \"total\",\n  name: `Total Bill ${currentCurrency()}`\n}, {\n  id: \"amount\",\n  name: `Amount Paid ${currentCurrency()}`\n}, {\n  id: \"owe\",\n  name: `Amount Owed ${currentCurrency()}`\n}];\nfunction DebtorsList() {\n  _s();\n  const [data, setdata] = useState([]);\n  const [year, setyear] = useState(\"\");\n  const [term, setterm] = useState(\"\");\n  const [classID, setclassID] = useState(\"all\");\n  const [campus, setcampus] = useState(\"\");\n  const [show, setshow] = useState(false);\n  const [loading, setloading] = useState(false);\n  const [fees, setfees] = useState([]);\n  const [openLetter, setopenLetter] = useState(false);\n  const [openMessage, setopenMessage] = useState(false);\n  const [selected, setSelected] = useState([]);\n  useEffect(() => {\n    axios.get(\"/fees\").then(res => {\n      setfees(res.data);\n    });\n  }, []);\n  const handleSearch = () => {\n    setloading(true);\n    let bal = u => {\n      let fee = fees.find(z => (z === null || z === void 0 ? void 0 : z.code) === (u === null || u === void 0 ? void 0 : u.classID));\n      return fee ? Object.values(fee[u.status] || {}).reduce((t, v) => Number(t) + Number(v), 0) : 0;\n    };\n    axios.get(`/students/unpaidfees/${year}/${term}`).then(res => {\n      let students = res.data.map(e => {\n        let total = bal(e);\n        return {\n          ...e,\n          bill: total,\n          owe: total - e.amount,\n          total\n        };\n      });\n      let dataAll = students.filter(e => e.owe > 0);\n      if (classID !== \"all\") {\n        dataAll = dataAll.filter(e => e.classID === classID);\n      }\n      setdata(dataAll);\n      setshow(true);\n      setloading(false);\n    });\n  };\n  let debtors = selected.map(e => {\n    let student = data.find(i => i.userID === e);\n    return {\n      ...student\n    };\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \" Bill Reminder\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content__container mb-5\",\n      children: /*#__PURE__*/_jsxDEV(Search, {\n        year: year,\n        setyear: setyear,\n        term: term,\n        handleSearch: handleSearch,\n        classID: classID,\n        setclassID: setclassID,\n        campus: campus,\n        setcampus: setcampus,\n        setterm: setterm,\n        loading: loading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), show && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content__container\",\n        id: \"section-to-print\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\"DEBTORS LIST FOR \", term, \"/ \", year]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Table, {\n          selected: selected,\n          setSelected: setSelected,\n          tableHeader: tableHeader,\n          data: data\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center my-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setopenLetter(true),\n          className: \"btn blue__btn mr-2\",\n          children: \"Continue\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setopenMessage(true),\n          className: \"btn blue__btn ml-3\",\n          children: \"send message\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), debtors.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Message, {\n        debtors: debtors,\n        open: openMessage,\n        setOpen: setopenMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Reminder, {\n        debtors: debtors,\n        open: openLetter,\n        setOpen: setopenLetter\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n}\n_s(DebtorsList, \"nWuZUdcSyKe7kkQ/cTrb/3+QMBY=\");\n_c = DebtorsList;\nexport default DebtorsList;\nvar _c;\n$RefreshReg$(_c, \"DebtorsList\");","map":{"version":3,"names":["React","useEffect","useState","Search","Table","axios","Reminder","Message","currentCurrency","jsxDEV","_jsxDEV","Fragment","_Fragment","tableHeader","id","name","DebtorsList","_s","data","setdata","year","setyear","term","setterm","classID","setclassID","campus","setcampus","show","setshow","loading","setloading","fees","setfees","openLetter","setopenLetter","openMessage","setopenMessage","selected","setSelected","get","then","res","handleSearch","bal","u","fee","find","z","code","Object","values","status","reduce","t","v","Number","students","map","e","total","bill","owe","amount","dataAll","filter","debtors","student","i","userID","children","fileName","_jsxFileName","lineNumber","columnNumber","className","onClick","length","open","setOpen","_c","$RefreshReg$"],"sources":["C:/Users/Abdul Rehman/Desktop/Project/First_And_Second_Module_v1.0/frontend/src/AdminComponents/finance/billReminder/DebtorsList.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Search from \"./Search\";\nimport Table from \"./Table\";\nimport axios from \"../../../store/axios\";\nimport Reminder from \"./SendLetter\";\nimport Message from \"./SendMessage\";\nimport { currentCurrency } from \"../../../utils\";\n\nconst tableHeader = [\n  { id: \"userID\", name: \"Student ID\" },\n  { id: \"name\", name: \"Name\" },\n  { id: \"classID\", name: \"Class\" },\n  { id: \"total\", name: `Total Bill ${currentCurrency()}` },\n  { id: \"amount\", name: `Amount Paid ${currentCurrency()}` },\n\n  { id: \"owe\", name: `Amount Owed ${currentCurrency()}` },\n];\n\nfunction DebtorsList() {\n  const [data, setdata] = useState([]);\n  const [year, setyear] = useState(\"\");\n  const [term, setterm] = useState(\"\");\n  const [classID, setclassID] = useState(\"all\");\n  const [campus, setcampus] = useState(\"\");\n  const [show, setshow] = useState(false);\n  const [loading, setloading] = useState(false);\n  const [fees, setfees] = useState([]);\n  const [openLetter, setopenLetter] = useState(false);\n  const [openMessage, setopenMessage] = useState(false);\n  const [selected, setSelected] = useState([]);\n\n  useEffect(() => {\n    axios.get(\"/fees\").then((res) => {\n      setfees(res.data);\n    });\n  }, []);\n\n  const handleSearch = () => {\n    setloading(true);\n    let bal = (u) => {\n      let fee = fees.find((z) => z?.code === u?.classID);\n      return fee\n        ? Object.values(fee[u.status] || {}).reduce(\n            (t, v) => Number(t) + Number(v),\n            0\n          )\n        : 0;\n    };\n    axios.get(`/students/unpaidfees/${year}/${term}`).then((res) => {\n      let students = res.data.map((e) => {\n        let total = bal(e);\n        return {\n          ...e,\n          bill: total,\n          owe: total - e.amount,\n          total,\n        };\n      });\n      let dataAll = students.filter((e) => e.owe > 0);\n\n      if (classID !== \"all\") {\n        dataAll = dataAll.filter((e) => e.classID === classID);\n      }\n      setdata(dataAll);\n      setshow(true);\n      setloading(false);\n    });\n  };\n\n  let debtors = selected.map((e) => {\n    let student = data.find((i) => i.userID === e);\n    return {\n      ...student,\n    };\n  });\n\n  return (\n    <div>\n      <h3> Bill Reminder</h3>\n      <div className=\"content__container mb-5\">\n        <Search\n          year={year}\n          setyear={setyear}\n          term={term}\n          handleSearch={handleSearch}\n          classID={classID}\n          setclassID={setclassID}\n          campus={campus}\n          setcampus={setcampus}\n          setterm={setterm}\n          loading={loading}\n        />\n      </div>\n      {show && (\n        <>\n          <div className=\"content__container\" id=\"section-to-print\">\n            <div className=\"text-center\">\n              <h3>\n                DEBTORS LIST FOR {term}/ {year}\n              </h3>\n            </div>\n            <Table\n              selected={selected}\n              setSelected={setSelected}\n              tableHeader={tableHeader}\n              data={data}\n            />\n          </div>\n          <div className=\"text-center my-2\">\n            <button\n              onClick={() => setopenLetter(true)}\n              className=\"btn blue__btn mr-2\"\n            >\n              Continue\n            </button>\n            <button\n              onClick={() => setopenMessage(true)}\n              className=\"btn blue__btn ml-3\"\n            >\n              send message\n            </button>\n          </div>\n        </>\n      )}\n      {debtors.length > 0 && (\n        <>\n          <Message\n            debtors={debtors}\n            open={openMessage}\n            setOpen={setopenMessage}\n          />\n          <Reminder\n            debtors={debtors}\n            open={openLetter}\n            setOpen={setopenLetter}\n          />\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default DebtorsList;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}