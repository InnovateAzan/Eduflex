{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Abdul Rehman\\\\Desktop\\\\Project\\\\First_And_Second_Module_v1.0\\\\frontend\\\\src\\\\components\\\\messages\\\\inbox\\\\MessageContainer.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport Message from \"./Message\";\nimport { useParams } from \"react-router-dom\";\nimport axios from \"../../../store/axios\";\nimport { useSelector } from \"react-redux\";\nimport { selectUser } from \"../../../store/slices/userSlice\";\nimport { Avatar } from \"@material-ui/core\";\nimport { getImgSrc, getCapitalize, getIntial } from \"../../../utils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction MessageContainer() {\n  _s();\n  const {\n    id\n  } = useParams();\n  const [messages, setmessages] = useState([]);\n  const [message, setmessage] = useState(\"\");\n  const [user, setuser] = useState({});\n  const currentUser = useSelector(selectUser);\n  const messagesEndRef = /*#__PURE__*/React.createRef();\n  useEffect(() => {\n    scrollToBottom();\n  });\n  const scrollToBottom = () => {\n    messagesEndRef.current.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  };\n  useEffect(() => {\n    axios.get(`/chats/chat/${id}`).then(async res => {\n      var _res$data, _res$data2, _res$data3, _res$data4;\n      setmessages((_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.messages);\n      let userId = (currentUser === null || currentUser === void 0 ? void 0 : currentUser.id) === ((_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.requestor_id) ? (_res$data3 = res.data) === null || _res$data3 === void 0 ? void 0 : _res$data3.acceptor_id : (_res$data4 = res.data) === null || _res$data4 === void 0 ? void 0 : _res$data4.requestor_id;\n      await axios.get(`/user/${userId}`).then(response => {\n        setuser(response.data.user);\n      });\n    });\n  }, [id, currentUser]);\n  const handleSendMessage = e => {\n    e.preventDefault();\n    if (message) {\n      axios.put(`/chats/send/${id}`, {\n        message,\n        senderID: currentUser === null || currentUser === void 0 ? void 0 : currentUser.id,\n        channelID: id\n      }).then(res => {\n        var _res$data$doc;\n        console.log(res.data);\n        setmessages((_res$data$doc = res.data.doc) === null || _res$data$doc === void 0 ? void 0 : _res$data$doc.messages);\n        setmessage(\"\");\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"message__container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header d-flex\",\n      children: [/*#__PURE__*/_jsxDEV(Avatar, {\n        src: getImgSrc(user === null || user === void 0 ? void 0 : user.profileUrl),\n        alt: getIntial((user === null || user === void 0 ? void 0 : user.name) || \"U\")\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ml-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n          children: [\" \", getCapitalize((user === null || user === void 0 ? void 0 : user.name) || \"A\"), \" \", getCapitalize(user === null || user === void 0 ? void 0 : user.surname)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: user === null || user === void 0 ? void 0 : user.userID\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"message__messages p-2\",\n      children: [messages && messages.map(e => /*#__PURE__*/_jsxDEV(Message, {\n        message: e,\n        currentUser: currentUser === null || currentUser === void 0 ? void 0 : currentUser.id\n      }, e._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 13\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSendMessage,\n      className: \"send\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        value: message,\n        onChange: e => setmessage(e.target.value),\n        type: \"text\",\n        placeholder: \"Type here ...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"btn\",\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n}\n_s(MessageContainer, \"X8v/O2GwP5FyeFwmJj8ojVk/QLk=\", false, function () {\n  return [useParams, useSelector];\n});\n_c = MessageContainer;\nexport default MessageContainer;\nvar _c;\n$RefreshReg$(_c, \"MessageContainer\");","map":{"version":3,"names":["React","useState","useEffect","Message","useParams","axios","useSelector","selectUser","Avatar","getImgSrc","getCapitalize","getIntial","jsxDEV","_jsxDEV","MessageContainer","_s","id","messages","setmessages","message","setmessage","user","setuser","currentUser","messagesEndRef","createRef","scrollToBottom","current","scrollIntoView","behavior","get","then","res","_res$data","_res$data2","_res$data3","_res$data4","data","userId","requestor_id","acceptor_id","response","handleSendMessage","e","preventDefault","put","senderID","channelID","_res$data$doc","console","log","doc","className","children","src","profileUrl","alt","name","fileName","_jsxFileName","lineNumber","columnNumber","surname","userID","map","_id","ref","onSubmit","value","onChange","target","type","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/Abdul Rehman/Desktop/Project/First_And_Second_Module_v1.0/frontend/src/components/messages/inbox/MessageContainer.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Message from \"./Message\";\nimport { useParams } from \"react-router-dom\";\nimport axios from \"../../../store/axios\";\nimport { useSelector } from \"react-redux\";\nimport { selectUser } from \"../../../store/slices/userSlice\";\nimport { Avatar } from \"@material-ui/core\";\nimport { getImgSrc, getCapitalize, getIntial } from \"../../../utils\";\n\nfunction MessageContainer() {\n  const { id } = useParams();\n  const [messages, setmessages] = useState([]);\n  const [message, setmessage] = useState(\"\");\n  const [user, setuser] = useState({});\n  const currentUser = useSelector(selectUser);\n\n  const messagesEndRef = React.createRef();\n\n  useEffect(() => {\n    scrollToBottom();\n  });\n\n  const scrollToBottom = () => {\n    messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(() => {\n    axios.get(`/chats/chat/${id}`).then(async (res) => {\n      setmessages(res.data?.messages);\n      let userId =\n        currentUser?.id === res.data?.requestor_id\n          ? res.data?.acceptor_id\n          : res.data?.requestor_id;\n      await axios.get(`/user/${userId}`).then((response) => {\n        setuser(response.data.user);\n      });\n    });\n  }, [id, currentUser]);\n\n  const handleSendMessage = (e) => {\n    e.preventDefault();\n    if (message) {\n      axios\n        .put(`/chats/send/${id}`, {\n          message,\n          senderID: currentUser?.id,\n          channelID: id,\n        })\n        .then((res) => {\n          console.log(res.data);\n          setmessages(res.data.doc?.messages);\n          setmessage(\"\");\n        });\n    }\n  };\n\n  return (\n    <div className=\"message__container\">\n      <div className=\"header d-flex\">\n        <Avatar\n          src={getImgSrc(user?.profileUrl)}\n          alt={getIntial(user?.name || \"U\")}\n        />\n        <div className=\"ml-3\">\n          <h6>\n            {\" \"}\n            {getCapitalize(user?.name || \"A\")} {getCapitalize(user?.surname)}\n          </h6>\n          <span>{user?.userID}</span>\n        </div>\n      </div>\n      <div className=\"message__messages p-2\">\n        {messages &&\n          messages.map((e) => (\n            <Message message={e} key={e._id} currentUser={currentUser?.id} />\n          ))}\n        <div ref={messagesEndRef} />\n      </div>\n      <form onSubmit={handleSendMessage} className=\"send\">\n        <input\n          value={message}\n          onChange={(e) => setmessage(e.target.value)}\n          type=\"text\"\n          placeholder=\"Type here ...\"\n        />\n        <button type=\"submit\" className=\"btn\">\n          Send\n        </button>\n      </form>\n    </div>\n  );\n}\n\nexport default MessageContainer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}