{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Abdul Rehman\\\\Desktop\\\\Project\\\\First_And_Second_Module_v1.0\\\\frontend\\\\src\\\\components\\\\profile\\\\UpdateProfile.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport PhotoCamera from \"@material-ui/icons/PhotoCamera\";\nimport { Avatar } from \"@material-ui/core\";\nimport { errorAlert, getImgSrc } from \"../../utils\";\nimport axios from \"../../store/axios\";\nimport { useDispatch } from \"react-redux\";\nimport { update } from \"../../store/slices/userSlice\";\nimport { LoginString } from \"../../store/localStorage\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    \"& > *\": {\n      margin: theme.spacing(1)\n    }\n  },\n  input: {\n    display: \"none\"\n  },\n  profileIcon: {}\n}));\nfunction UpdateProfile(_ref) {\n  _s();\n  let {\n    id,\n    profile\n  } = _ref;\n  const classes = useStyles();\n  const [profileimg, setprofileimg] = useState(\"\");\n  const [loading, setloading] = useState(false);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    setprofileimg(profile);\n  }, [profile]);\n  const handleChangeFile = e => {\n    const selected = e.target.files[0];\n    if ((selected === null || selected === void 0 ? void 0 : selected.size) > 2000000) {\n      errorAlert(\"image is too large\");\n    } else if (selected) {\n      setloading(true);\n      const fileReader = new FileReader();\n      fileReader.readAsDataURL(selected);\n      fileReader.onloadend = () => {\n        axios.post(\"/upload\", {\n          dataUrl: fileReader.result\n        }).then(res => {\n          const path = res.data.url;\n          console.log(path);\n          axios.post(`/update/profile/${id}`, {\n            profileUrl: path\n          }).then(response => {\n            setloading(false);\n            if (response.data.error) {\n              errorAlert(\"Profile update failed\");\n              return 0;\n            }\n            setprofileimg(path);\n            dispatch(update({\n              photoUrl: path\n            }));\n            localStorage.setItem(LoginString.PhotoURL, path);\n          });\n        }).catch(err => {\n          console.log(err);\n          setloading(false);\n          errorAlert(\"Profile update failed\");\n        });\n      };\n    } else {\n      console.log(\"no file selected\");\n      errorAlert(\"no file selected\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      accept: \"image/*\",\n      onChange: handleChangeFile,\n      className: classes.input,\n      disabled: loading,\n      id: \"icon-button-file\",\n      type: \"file\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      className: \"profileContainer\",\n      htmlFor: \"icon-button-file\",\n      children: [/*#__PURE__*/_jsxDEV(Avatar, {\n        src: getImgSrc(profileimg),\n        className: \"large__avatar\",\n        \"aria-label\": \"upload picture\",\n        component: \"span\",\n        children: loading ? /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 22\n        }, this) : /*#__PURE__*/_jsxDEV(PhotoCamera, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 45\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profileIcon\",\n        children: \"Change Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n}\n_s(UpdateProfile, \"oZ5d3OQ5fQX12POrW+/izNzTgCQ=\", false, function () {\n  return [useStyles, useDispatch];\n});\n_c = UpdateProfile;\nexport default UpdateProfile;\nvar _c;\n$RefreshReg$(_c, \"UpdateProfile\");","map":{"version":3,"names":["React","useState","useEffect","makeStyles","PhotoCamera","Avatar","errorAlert","getImgSrc","axios","useDispatch","update","LoginString","CircularProgress","jsxDEV","_jsxDEV","useStyles","theme","root","margin","spacing","input","display","profileIcon","UpdateProfile","_ref","_s","id","profile","classes","profileimg","setprofileimg","loading","setloading","dispatch","handleChangeFile","e","selected","target","files","size","fileReader","FileReader","readAsDataURL","onloadend","post","dataUrl","result","then","res","path","data","url","console","log","profileUrl","response","error","photoUrl","localStorage","setItem","PhotoURL","catch","err","children","accept","onChange","className","disabled","type","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","src","component","_c","$RefreshReg$"],"sources":["C:/Users/Abdul Rehman/Desktop/Project/First_And_Second_Module_v1.0/frontend/src/components/profile/UpdateProfile.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport PhotoCamera from \"@material-ui/icons/PhotoCamera\";\nimport { Avatar } from \"@material-ui/core\";\nimport { errorAlert, getImgSrc } from \"../../utils\";\nimport axios from \"../../store/axios\";\nimport { useDispatch } from \"react-redux\";\nimport { update } from \"../../store/slices/userSlice\";\nimport { LoginString } from \"../../store/localStorage\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    \"& > *\": {\n      margin: theme.spacing(1),\n    },\n  },\n  input: {\n    display: \"none\",\n  },\n  profileIcon: {},\n}));\n\nfunction UpdateProfile({ id, profile }) {\n  const classes = useStyles();\n  const [profileimg, setprofileimg] = useState(\"\");\n  const [loading, setloading] = useState(false);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    setprofileimg(profile);\n  }, [profile]);\n\n  const handleChangeFile = (e) => {\n    const selected = e.target.files[0];\n    if (selected?.size > 2000000) {\n      errorAlert(\"image is too large\");\n    } else if (selected) {\n      setloading(true);\n      const fileReader = new FileReader();\n      fileReader.readAsDataURL(selected);\n      fileReader.onloadend = () => {\n        axios\n          .post(\"/upload\", { dataUrl: fileReader.result })\n          .then((res) => {\n            const path = res.data.url;\n            console.log(path);\n            axios\n              .post(`/update/profile/${id}`, { profileUrl: path })\n              .then((response) => {\n                setloading(false);\n                if (response.data.error) {\n                  errorAlert(\"Profile update failed\");\n                  return 0;\n                }\n                setprofileimg(path);\n                dispatch(\n                  update({\n                    photoUrl: path,\n                  })\n                );\n                localStorage.setItem(LoginString.PhotoURL, path);\n              });\n          })\n          .catch((err) => {\n            console.log(err);\n            setloading(false);\n            errorAlert(\"Profile update failed\");\n          });\n      };\n    } else {\n      console.log(\"no file selected\");\n      errorAlert(\"no file selected\");\n    }\n  };\n\n  return (\n    <div>\n      <input\n        accept=\"image/*\"\n        onChange={handleChangeFile}\n        className={classes.input}\n        disabled={loading}\n        id=\"icon-button-file\"\n        type=\"file\"\n      />\n      <label className=\"profileContainer\" htmlFor=\"icon-button-file\">\n        <Avatar\n          src={getImgSrc(profileimg)}\n          className=\"large__avatar\"\n          aria-label=\"upload picture\"\n          component=\"span\"\n        >\n          {loading ? <CircularProgress /> : <PhotoCamera />}\n        </Avatar>\n\n        <div className=\"profileIcon\">Change Profile</div>\n      </label>\n    </div>\n  );\n}\n\nexport default UpdateProfile;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}