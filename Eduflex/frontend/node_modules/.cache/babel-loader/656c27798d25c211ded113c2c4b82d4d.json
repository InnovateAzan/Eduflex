{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Abdul Rehman\\\\Desktop\\\\Project\\\\First_And_Second_Module_v1.0\\\\frontend\\\\src\\\\TeachersComponents\\\\academics\\\\SBA.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport Table from \"../../AdminComponents/academics/sba/SbaTable\";\nimport Edit from \"../../AdminComponents/academics/sba/EditModal\";\nimport axios from \"../../store/axios\";\nimport { useParams } from \"react-router-dom\";\nimport { errorAlert } from \"../../utils\";\nimport { useSelector } from \"react-redux\";\nimport { selectacademicYear } from \"../../store/slices/schoolSlice\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction SBA() {\n  _s();\n  const [students, setstudents] = useState([]);\n  const [exam, setexam] = useState(\"\");\n  const [openEdit, setopenEdit] = useState(false);\n  const [data, setdata] = useState([]);\n  const currentYear = useSelector(selectacademicYear);\n  const [selectedUser, setselectedUser] = useState({});\n  const {\n    id,\n    classID\n  } = useParams();\n  const [position, setposition] = useState(\"\");\n  const [loadingSubmit, setloadingSubmit] = useState(false);\n  const [error, seterror] = useState(false);\n  const [examMark, setexamMark] = useState(\"\");\n  const [classWork, setclassWork] = useState(\"\");\n  const [classworkMark, setclassworkMark] = useState(\"\");\n  useEffect(() => {\n    axios.get(`/classes/classCode/${classID}`).then(res => {\n      var _res$data$docs, _res$data$docs2;\n      if (!((_res$data$docs = res.data.docs) !== null && _res$data$docs !== void 0 && _res$data$docs.sba) || ((_res$data$docs2 = res.data.docs) === null || _res$data$docs2 === void 0 ? void 0 : _res$data$docs2.sba) === false) {\n        seterror(true);\n        return errorAlert(\"SBA not set for this class\");\n      }\n      axios.get(`/sba/${classID}/${id}/${currentYear === null || currentYear === void 0 ? void 0 : currentYear.currentYear}/${currentYear === null || currentYear === void 0 ? void 0 : currentYear.currentTerm}`).then(result => {\n        var _result$data$docs, _result$data$docs2, _result$data$docs3;\n        console.log(\"guess course Id\", id);\n        setdata(result.data.docs);\n        setstudents((_result$data$docs = result.data.docs) === null || _result$data$docs === void 0 ? void 0 : _result$data$docs.students);\n        setclassworkMark((_result$data$docs2 = result.data.docs) === null || _result$data$docs2 === void 0 ? void 0 : _result$data$docs2.classWork);\n        setexamMark((_result$data$docs3 = result.data.docs) === null || _result$data$docs3 === void 0 ? void 0 : _result$data$docs3.exam);\n      });\n    });\n  }, [currentYear, id, classID]);\n  const handleEdit = id => {\n    if (!classworkMark) {\n      return errorAlert(\"Please set  classWork %\");\n    }\n    if (!examMark) {\n      return errorAlert(\"Please set  exam score %\");\n    }\n    setopenEdit(true);\n    let selectedStudent = data.students.find(e => e.userID === id);\n    setselectedUser(selectedStudent);\n    setexam(selectedStudent === null || selectedStudent === void 0 ? void 0 : selectedStudent.exam);\n    setclassWork(selectedStudent === null || selectedStudent === void 0 ? void 0 : selectedStudent.classWork);\n    setposition(selectedStudent === null || selectedStudent === void 0 ? void 0 : selectedStudent.position);\n  };\n  const handleonSubmit = async () => {\n    setloadingSubmit(true);\n    await axios.put(`/sba/update/${data === null || data === void 0 ? void 0 : data._id}`, {\n      exam: examMark,\n      classWork: classworkMark\n    });\n    axios.put(`/sba/update/student/${data === null || data === void 0 ? void 0 : data._id}/${selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.userID}`, {\n      classWork,\n      exam,\n      userID: selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.userID,\n      name: selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.name,\n      position: position\n    }).then(res => {\n      var _res$data$doc;\n      setopenEdit(false);\n      setloadingSubmit(false);\n      setstudents((_res$data$doc = res.data.doc) === null || _res$data$doc === void 0 ? void 0 : _res$data$doc.students);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: error ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"SBA is not set for this class\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Table, {\n        setclassWork: setclassWork,\n        rows: students,\n        handleEdit: handleEdit,\n        examMark: examMark,\n        setexamMark: setexamMark,\n        classworkMark: classworkMark,\n        setclassworkMark: setclassworkMark\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Edit, {\n        name: selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.name,\n        userID: selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.userID,\n        exam: exam,\n        classworkMark: classworkMark,\n        examMark: examMark,\n        classID: classID,\n        loading: loadingSubmit,\n        setposition: setposition,\n        position: position,\n        setexam: setexam,\n        setclassWork: setclassWork,\n        classWork: classWork,\n        open: openEdit,\n        onSubmit: handleonSubmit,\n        setOpen: setopenEdit\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this), \" \"]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n}\n_s(SBA, \"Uep/Scr/U+G3VJ/W13/GUJOfgbA=\", false, function () {\n  return [useSelector, useParams];\n});\n_c = SBA;\nexport default SBA;\nvar _c;\n$RefreshReg$(_c, \"SBA\");","map":{"version":3,"names":["React","useState","useEffect","Table","Edit","axios","useParams","errorAlert","useSelector","selectacademicYear","jsxDEV","_jsxDEV","Fragment","_Fragment","SBA","_s","students","setstudents","exam","setexam","openEdit","setopenEdit","data","setdata","currentYear","selectedUser","setselectedUser","id","classID","position","setposition","loadingSubmit","setloadingSubmit","error","seterror","examMark","setexamMark","classWork","setclassWork","classworkMark","setclassworkMark","get","then","res","_res$data$docs","_res$data$docs2","docs","sba","currentTerm","result","_result$data$docs","_result$data$docs2","_result$data$docs3","console","log","handleEdit","selectedStudent","find","e","userID","handleonSubmit","put","_id","name","_res$data$doc","doc","children","fileName","_jsxFileName","lineNumber","columnNumber","rows","loading","open","onSubmit","setOpen","_c","$RefreshReg$"],"sources":["C:/Users/Abdul Rehman/Desktop/Project/First_And_Second_Module_v1.0/frontend/src/TeachersComponents/academics/SBA.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Table from \"../../AdminComponents/academics/sba/SbaTable\";\nimport Edit from \"../../AdminComponents/academics/sba/EditModal\";\n\nimport axios from \"../../store/axios\";\nimport { useParams } from \"react-router-dom\";\nimport { errorAlert } from \"../../utils\";\nimport { useSelector } from \"react-redux\";\nimport { selectacademicYear } from \"../../store/slices/schoolSlice\";\n\nfunction SBA() {\n  const [students, setstudents] = useState([]);\n  const [exam, setexam] = useState(\"\");\n  const [openEdit, setopenEdit] = useState(false);\n  const [data, setdata] = useState([]);\n  const currentYear = useSelector(selectacademicYear);\n  const [selectedUser, setselectedUser] = useState({});\n  const { id, classID } = useParams();\n  const [position, setposition] = useState(\"\");\n  const [loadingSubmit, setloadingSubmit] = useState(false);\n  const [error, seterror] = useState(false);\n  const [examMark, setexamMark] = useState(\"\");\n  const [classWork, setclassWork] = useState(\"\");\n  const [classworkMark, setclassworkMark] = useState(\"\");\n\n  useEffect(() => {\n    axios.get(`/classes/classCode/${classID}`).then((res) => {\n      if (!res.data.docs?.sba || res.data.docs?.sba === false) {\n        seterror(true);\n        return errorAlert(\"SBA not set for this class\");\n      }\n      axios\n        .get(\n          `/sba/${classID}/${id}/${currentYear?.currentYear}/${currentYear?.currentTerm}`\n        )\n        .then((result) => {\n          console.log(\"guess course Id\" , id)\n          setdata(result.data.docs);\n          setstudents(result.data.docs?.students);\n          setclassworkMark(result.data.docs?.classWork);\n          setexamMark(result.data.docs?.exam);\n        });\n    });\n  }, [currentYear, id, classID]);\n\n  const handleEdit = (id) => {\n    if (!classworkMark) {\n      return errorAlert(\"Please set  classWork %\");\n    }\n    if (!examMark) {\n      return errorAlert(\"Please set  exam score %\");\n    }\n    setopenEdit(true);\n    let selectedStudent = data.students.find((e) => e.userID === id);\n    setselectedUser(selectedStudent);\n    setexam(selectedStudent?.exam);\n    setclassWork(selectedStudent?.classWork);\n    setposition(selectedStudent?.position);\n  };\n\n  const handleonSubmit = async () => {\n    setloadingSubmit(true);\n    await axios.put(`/sba/update/${data?._id}`, {\n      exam: examMark,\n      classWork: classworkMark,\n    });\n    axios\n      .put(`/sba/update/student/${data?._id}/${selectedUser?.userID}`, {\n        classWork,\n        exam,\n        userID: selectedUser?.userID,\n        name: selectedUser?.name,\n        position: position,\n      })\n      .then((res) => {\n        setopenEdit(false);\n        setloadingSubmit(false);\n        setstudents(res.data.doc?.students);\n      });\n  };\n\n  return (\n    <div>\n      {error ? (\n        <div>SBA is not set for this class</div>\n      ) : (\n        <>\n          <Table\n            setclassWork={setclassWork}\n            rows={students}\n            handleEdit={handleEdit}\n            examMark={examMark}\n            setexamMark={setexamMark}\n            classworkMark={classworkMark}\n            setclassworkMark={setclassworkMark}\n          />\n          <Edit\n            name={selectedUser?.name}\n            userID={selectedUser?.userID}\n            exam={exam}\n            classworkMark={classworkMark}\n            examMark={examMark}\n            classID={classID}\n            loading={loadingSubmit}\n            setposition={setposition}\n            position={position}\n            setexam={setexam}\n            setclassWork={setclassWork}\n            classWork={classWork}\n            open={openEdit}\n            onSubmit={handleonSubmit}\n            setOpen={setopenEdit}\n          />{\" \"}\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default SBA;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}