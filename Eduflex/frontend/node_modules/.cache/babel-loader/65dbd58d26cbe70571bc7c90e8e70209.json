{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Abdul Rehman\\\\Desktop\\\\Project\\\\First_And_Second_Module_v1.0\\\\frontend\\\\src\\\\components\\\\messages\\\\inbox\\\\SidebarMessage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Avatar } from \"@material-ui/core\";\nimport axios from \"../../../store/axios\";\nimport { getIntial, getImgSrc, getCapitalize, timeStamp, getTrimString } from \"../../../utils\";\nimport { selectNotifications, setNotifications } from \"../../../store/slices/schoolSlice\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction SidebarMessage(_ref) {\n  _s();\n  let {\n    chat,\n    currentUser\n  } = _ref;\n  const [user, setuser] = useState({});\n  const [lastmessage, setlastmessage] = useState({});\n  const messages = useSelector(selectNotifications);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    let userId = currentUser === (chat === null || chat === void 0 ? void 0 : chat.requestor_id) ? chat === null || chat === void 0 ? void 0 : chat.acceptor_id : chat === null || chat === void 0 ? void 0 : chat.requestor_id;\n    axios.get(`/user/${userId.trim()}`).then(res => {\n      let data = res.data.user;\n      setuser({\n        profileUrl: data === null || data === void 0 ? void 0 : data.profileUrl,\n        name: data === null || data === void 0 ? void 0 : data.name,\n        surname: data === null || data === void 0 ? void 0 : data.surname\n      });\n      setlastmessage(chat === null || chat === void 0 ? void 0 : chat.messages.pop());\n    });\n  }, [chat, currentUser]);\n  const handleOpen = async id => {\n    await axios.put(`/chats/update/chat/${id}/${currentUser}`).then(res => {\n      console.log(res);\n      let newMessages = messages.filter(i => i.type !== \"chat\");\n      dispatch(setNotifications(newMessages));\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"sidemessage\",\n    children: /*#__PURE__*/_jsxDEV(Link, {\n      onClick: () => handleOpen(chat === null || chat === void 0 ? void 0 : chat._id),\n      to: `/messages/chat/${chat === null || chat === void 0 ? void 0 : chat._id}`,\n      className: \"d-flex\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mr-2\",\n        children: /*#__PURE__*/_jsxDEV(Avatar, {\n          alt: getIntial((user === null || user === void 0 ? void 0 : user.name) || \"O\"),\n          src: getImgSrc(user === null || user === void 0 ? void 0 : user.profileUrl)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex align-center justify-content-between w-100\",\n          children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n            children: [getCapitalize(user === null || user === void 0 ? void 0 : user.name), \" \", (user === null || user === void 0 ? void 0 : user.surname) && getTrimString(getCapitalize(user === null || user === void 0 ? void 0 : user.surname), 5)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n            className: \"text-muted\",\n            children: timeStamp(lastmessage === null || lastmessage === void 0 ? void 0 : lastmessage.date)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: getTrimString((lastmessage === null || lastmessage === void 0 ? void 0 : lastmessage.message) || \"last message...\", 20)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n}\n_s(SidebarMessage, \"HO/4+oiNVW0qPKC+teislglRYao=\", false, function () {\n  return [useSelector, useDispatch];\n});\n_c = SidebarMessage;\nexport default SidebarMessage;\nvar _c;\n$RefreshReg$(_c, \"SidebarMessage\");","map":{"version":3,"names":["React","useState","useEffect","Link","Avatar","axios","getIntial","getImgSrc","getCapitalize","timeStamp","getTrimString","selectNotifications","setNotifications","useSelector","useDispatch","jsxDEV","_jsxDEV","SidebarMessage","_ref","_s","chat","currentUser","user","setuser","lastmessage","setlastmessage","messages","dispatch","userId","requestor_id","acceptor_id","get","trim","then","res","data","profileUrl","name","surname","pop","handleOpen","id","put","console","log","newMessages","filter","i","type","className","children","onClick","_id","to","alt","src","fileName","_jsxFileName","lineNumber","columnNumber","date","message","_c","$RefreshReg$"],"sources":["C:/Users/Abdul Rehman/Desktop/Project/First_And_Second_Module_v1.0/frontend/src/components/messages/inbox/SidebarMessage.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Avatar } from \"@material-ui/core\";\nimport axios from \"../../../store/axios\";\nimport {\n  getIntial,\n  getImgSrc,\n  getCapitalize,\n  timeStamp,\n  getTrimString,\n} from \"../../../utils\";\nimport {\n  selectNotifications,\n  setNotifications,\n} from \"../../../store/slices/schoolSlice\";\nimport { useSelector, useDispatch } from \"react-redux\";\n\nfunction SidebarMessage({ chat, currentUser }) {\n  const [user, setuser] = useState({});\n  const [lastmessage, setlastmessage] = useState({});\n  const messages = useSelector(selectNotifications);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    let userId =\n      currentUser === chat?.requestor_id\n        ? chat?.acceptor_id\n        : chat?.requestor_id;\n    axios.get(`/user/${userId.trim()}`).then((res) => {\n      let data = res.data.user;\n      setuser({\n        profileUrl: data?.profileUrl,\n        name: data?.name,\n        surname: data?.surname,\n      });\n      setlastmessage(chat?.messages.pop());\n    });\n  }, [chat, currentUser]);\n\n  const handleOpen = async (id) => {\n    await axios.put(`/chats/update/chat/${id}/${currentUser}`).then((res) => {\n      console.log(res);\n      let newMessages = messages.filter((i) => i.type !== \"chat\");\n      dispatch(setNotifications(newMessages));\n    });\n  };\n\n  return (\n    <div className=\"sidemessage\">\n      <Link\n        onClick={() => handleOpen(chat?._id)}\n        to={`/messages/chat/${chat?._id}`}\n        className=\"d-flex\"\n      >\n        <div className=\"mr-2\">\n          <Avatar\n            alt={getIntial(user?.name || \"O\")}\n            src={getImgSrc(user?.profileUrl)}\n          ></Avatar>\n        </div>\n        <div>\n          <div className=\"d-flex align-center justify-content-between w-100\">\n            <h6>\n              {getCapitalize(user?.name)}{\" \"}\n              {user?.surname && getTrimString(getCapitalize(user?.surname), 5)}\n            </h6>\n            <small className=\"text-muted\">{timeStamp(lastmessage?.date)}</small>\n          </div>\n          <span>\n            {getTrimString(lastmessage?.message || \"last message...\", 20)}\n          </span>\n        </div>\n      </Link>\n    </div>\n  );\n}\n\nexport default SidebarMessage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}