{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Abdul Rehman\\\\Desktop\\\\Project\\\\First_And_Second_Module_v1.0\\\\frontend\\\\src\\\\AdminComponents\\\\messages\\\\BulkMessage.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport SendForm from \"../../components/messages/SendToForm\";\nimport axios from \"../../store/axios\";\nimport { errorAlert, successAlert } from \"../../utils\";\nimport { useSelector } from \"react-redux\";\nimport { selectUser } from \"../../store/slices/userSlice\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction BulkMessage() {\n  _s();\n  const [message, setmessage] = useState(\"\");\n  const [recipient, setrecipient] = useState(\"\");\n  const sender = useSelector(selectUser);\n  const [loading, setloading] = useState(false);\n  const recipientsOptions = [{\n    id: \"students\",\n    name: \"All Students\"\n  }, {\n    id: \"parents\",\n    name: \"All Parents\"\n  }, {\n    id: \"staff\",\n    name: \"All Staff\"\n  }];\n\n  // sender: sender?.id,\n\n  const searchOptions = () => {\n    return recipientsOptions.map(option => /*#__PURE__*/_jsxDEV(\"option\", {\n      value: option.id,\n      children: option.name\n    }, option.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 7\n    }, this));\n  };\n  const handleSend = async e => {\n    e.preventDefault();\n    if (message && recipient) {\n      setloading(true);\n      switch (recipient) {\n        case \"staff\":\n          return await axios.get(\"/teachers\").then(res => {\n            let staff = res.data;\n            staff.map(async i => await axios.post(`/chats`, {\n              message,\n              telephone: i.telephone || (i === null || i === void 0 ? void 0 : i.mobilenumber),\n              senderID: sender === null || sender === void 0 ? void 0 : sender.id,\n              userID: i === null || i === void 0 ? void 0 : i.userID\n            }).then(response => {\n              setloading(false);\n              if (response.data.error) {\n                errorAlert(response.data.error);\n                return 0;\n              }\n              successAlert(\"message send to all staff members\");\n              setmessage(\"\");\n            }).catch(err => {\n              setloading(false);\n              console.log(err);\n            }));\n          });\n        case \"students\":\n          return await axios.get(\"/students\").then(res => {\n            let students = res.data;\n            students.map(async re => await axios.post(`/chats`, {\n              message,\n              userID: re === null || re === void 0 ? void 0 : re.userID,\n              telephone: re.telephone || (re === null || re === void 0 ? void 0 : re.mobilenumber),\n              senderID: sender === null || sender === void 0 ? void 0 : sender.id\n            }).then(response => {\n              setloading(false);\n              if (response.data.error) {\n                errorAlert(response.data.error);\n                return 0;\n              }\n              successAlert(\"message send to all students\");\n              setmessage(\"\");\n            }).catch(err => {\n              setloading(false);\n              console.log(err);\n            }));\n          });\n        case \"parents\":\n          return await axios.get(\"/students/parents\").then(res => {\n            let parents = res.data.docs;\n            console.log(parents);\n            // eslint-disable-next-line no-lone-blocks\n            {\n              parents.length > 0 ? parents.map(async i => await axios.post(`/chats`, {\n                message,\n                parent: i._id,\n                userID: \"parent\",\n                telephone: i === null || i === void 0 ? void 0 : i.mobile,\n                sender: sender === null || sender === void 0 ? void 0 : sender.id\n              }).then(response => {\n                setloading(false);\n                if (response.data.error) {\n                  errorAlert(response.data.error);\n                  return 0;\n                }\n                successAlert(\"message send to all parents\");\n                setmessage(\"\");\n              }).catch(err => {\n                setloading(false);\n                console.log(err);\n              })) : errorAlert(\"There are parents data\");\n              setloading(false);\n            }\n          });\n        default:\n          break;\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(SendForm, {\n      message: message,\n      setmessage: setmessage,\n      onSend: handleSend,\n      recipientsOptions: recipientsOptions,\n      recipient: recipient,\n      setrecipient: setrecipient,\n      sender: sender === null || sender === void 0 ? void 0 : sender.id,\n      loading: loading,\n      searchOptions: searchOptions,\n      sendto: \"All\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 132,\n    columnNumber: 5\n  }, this);\n}\n_s(BulkMessage, \"7mkqVUnccc27J6xenJ/5XlI3OjU=\", false, function () {\n  return [useSelector];\n});\n_c = BulkMessage;\nexport default BulkMessage;\nvar _c;\n$RefreshReg$(_c, \"BulkMessage\");","map":{"version":3,"names":["React","useState","SendForm","axios","errorAlert","successAlert","useSelector","selectUser","jsxDEV","_jsxDEV","BulkMessage","_s","message","setmessage","recipient","setrecipient","sender","loading","setloading","recipientsOptions","id","name","searchOptions","map","option","value","children","fileName","_jsxFileName","lineNumber","columnNumber","handleSend","e","preventDefault","get","then","res","staff","data","i","post","telephone","mobilenumber","senderID","userID","response","error","catch","err","console","log","students","re","parents","docs","length","parent","_id","mobile","onSend","sendto","_c","$RefreshReg$"],"sources":["C:/Users/Abdul Rehman/Desktop/Project/First_And_Second_Module_v1.0/frontend/src/AdminComponents/messages/BulkMessage.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport SendForm from \"../../components/messages/SendToForm\";\nimport axios from \"../../store/axios\";\nimport { errorAlert, successAlert } from \"../../utils\";\nimport { useSelector } from \"react-redux\";\nimport { selectUser } from \"../../store/slices/userSlice\";\n\nfunction BulkMessage() {\n  const [message, setmessage] = useState(\"\");\n  const [recipient, setrecipient] = useState(\"\");\n  const sender = useSelector(selectUser);\n  const [loading, setloading] = useState(false);\n\n  const recipientsOptions = [\n    { id: \"students\", name: \"All Students\" },\n    { id: \"parents\", name: \"All Parents\" },\n    { id: \"staff\", name: \"All Staff\" },\n  ];\n\n  // sender: sender?.id,\n\n  const searchOptions = () => {\n    return recipientsOptions.map((option) => (\n      <option key={option.id} value={option.id}>\n        {option.name}\n      </option>\n    ));\n  };\n\n  const handleSend = async (e) => {\n    e.preventDefault();\n\n    if (message && recipient) {\n      setloading(true);\n      switch (recipient) {\n        case \"staff\":\n          return await axios.get(\"/teachers\").then((res) => {\n            let staff = res.data;\n            staff.map(\n              async (i) =>\n                await axios\n                  .post(`/chats`, {\n                    message,\n                    telephone: i.telephone || i?.mobilenumber,\n                    senderID: sender?.id,\n                    userID: i?.userID,\n                  })\n                  .then((response) => {\n                    setloading(false);\n                    if (response.data.error) {\n                      errorAlert(response.data.error);\n                      return 0;\n                    }\n                    successAlert(\"message send to all staff members\");\n                    setmessage(\"\");\n                  })\n                  .catch((err) => {\n                    setloading(false);\n                    console.log(err);\n                  })\n            );\n          });\n        case \"students\":\n          return await axios.get(\"/students\").then((res) => {\n            let students = res.data;\n            students.map(\n              async (re) =>\n                await axios\n                  .post(`/chats`, {\n                    message,\n                    userID: re?.userID,\n                    telephone: re.telephone || re?.mobilenumber,\n                    senderID: sender?.id,\n                  })\n                  .then((response) => {\n                    setloading(false);\n                    if (response.data.error) {\n                      errorAlert(response.data.error);\n                      return 0;\n                    }\n                    successAlert(\"message send to all students\");\n                    setmessage(\"\");\n                  })\n                  .catch((err) => {\n                    setloading(false);\n                    console.log(err);\n                  })\n            );\n          });\n        case \"parents\":\n          return await axios.get(\"/students/parents\").then((res) => {\n            let parents = res.data.docs;\n            console.log(parents);\n            // eslint-disable-next-line no-lone-blocks\n            {\n              parents.length > 0\n                ? parents.map(\n                    async (i) =>\n                      await axios\n                        .post(`/chats`, {\n                          message,\n                          parent: i._id,\n                          userID: \"parent\",\n                          telephone: i?.mobile,\n                          sender: sender?.id,\n                        })\n                        .then((response) => {\n                          setloading(false);\n                          if (response.data.error) {\n                            errorAlert(response.data.error);\n                            return 0;\n                          }\n                          successAlert(\"message send to all parents\");\n                          setmessage(\"\");\n                        })\n                        .catch((err) => {\n                          setloading(false);\n                          console.log(err);\n                        })\n                  )\n                : errorAlert(\"There are parents data\");\n              setloading(false);\n            }\n          });\n        default:\n          break;\n      }\n    }\n  };\n\n  return (\n    <div>\n      <SendForm\n        message={message}\n        setmessage={setmessage}\n        onSend={handleSend}\n        recipientsOptions={recipientsOptions}\n        recipient={recipient}\n        setrecipient={setrecipient}\n        sender={sender?.id}\n        loading={loading}\n        searchOptions={searchOptions}\n        sendto=\"All\"\n      />\n    </div>\n  );\n}\n\nexport default BulkMessage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}